SOURCE_DIR=/Users/hemant/distribution-macOS/xnu
export CONFIG_DEFINES = -DINET -DMACH -DVLAN -DBOND -DIF_FAKE -DIF_HEADLESS -DIF_REDIRECT -DAH_ALL_CRYPTO -DPF -DPFLOG -DDUMMYNET -DTRAFFIC_MGT -DMULTICAST -DIFNET_INPUT_SANITY_CHK -DMULTIPATH -DMPTCP -DSYSV_SEM -DSYSV_MSG -DSYSV_SHM -DPSYNCH -DFLOW_DIVERT -DNECP -DCONTENT_FILTER -DPACKET_MANGLER -DREMOTE_VIF -DSKYWALK -DCONFIG_NEXUS_USER_PIPE -DCONFIG_NEXUS_KERNEL_PIPE -DCONFIG_NEXUS_MONITOR -DCONFIG_NEXUS_FLOWSWITCH -DCONFIG_NEXUS_NETIF -DKCTL_TEST -DSOCKETS -DSENDFILE -DNETWORKING -DCONFIG_FSE -DCONFIG_IMAGEBOOT -DCONFIG_MBUF_JUMBO -DFIFO -DFDESC -DDEVFS -DNULLFS -DFS_COMPRESSION -DQUOTA -DNAMEDSTREAMS -DCONFIG_APPLEDOUBLE -DCONFIG_VOLFS -DCONFIG_IMGSRC_ACCESS -DCONFIG_TRIGGERS -DCONFIG_EXT_RESOLVER -DCONFIG_SEARCHFS -DCONFIG_MNT_SUID -DCONFIG_MNT_ROOTSNAP -DCONFIG_ROSV_STARTUP -DCONFIG_FIRMLINKS -DCONFIG_MOUNT_VM -DCONFIG_MOUNT_PREBOOTRECOVERY -DCONFIG_DATALESS_FILES -DCONFIG_BASESYSTEMROOT -DCONFIG_UNION_MOUNTS -DCONFIG_FILE_LEASES -DCONFIG_IOCOUNT_TRACE -DNFSSERVER -DCONFIG_NETBOOT -DIPSEC -DIPSEC_ESP -DCRYPTO -DCRYPTO_SHA2 -DENCRYPTED_SWAP -DCONFIG_IMG4 -DZLIB -DIF_BRIDGE -DCONFIG_KN_HASHSIZE="64" -DCONFIG_VNODES="263168" -DCONFIG_NC_HASH="4096" -DCONFIG_VFS_NAMES="4096" -DCONFIG_MAX_CLUSTERS="8" -DCONFIG_MIN_NBUF="256" -DCONFIG_MIN_NIOBUF="128" -DCONFIG_NMBCLUSTERS="((1024 * 512) / MCLBYTES)" -DCONFIG_TCBHASHSIZE="4096" -DCONFIG_AIO_MAX="90" -DCONFIG_AIO_PROCESS_MAX="16" -DCONFIG_AIO_THREAD_COUNT="4" -DCONFIG_MAXVIFS="32" -DCONFIG_MFCTBLSIZ="256" -DCONFIG_MSG_BSIZE_REL="131072" -DCONFIG_MSG_BSIZE_DEV="131072" -DCONFIG_MSG_BSIZE="CONFIG_MSG_BSIZE_DEV" -DCONFIG_IPC_TABLE_ENTRIES_SIZE_MAX="7340032" -DCONFIG_IPC_TABLE_REQUEST_SIZE_MAX="2097152" -DCONFIG_IPC_KERNEL_MAP_SIZE="64" -DCONFIG_PMAP_PPL -DCONFIG_DYNAMIC_CODE_SIGNING -DCONFIG_SECOND_STATIC_TRUST_CACHE -DCONFIG_SUPPLEMENTAL_SIGNATURES -DCONFIG_CODE_DECRYPTION -DCONFIG_PROTECT -DCONFIG_MEMORYSTATUS -DCONFIG_DEFERRED_RECLAIM -DCONFIG_PHYS_WRITE_ACCT -DVM_PRESSURE_EVENTS -DCONFIG_LEDGER_INTERVAL_MAX -DCONFIG_IOSCHED -DCONFIG_IO_ACCOUNTING -DIMPORTANCE_INHERITANCE -DIMPORTANCE_TRACE -DCONFIG_TELEMETRY -DCONFIG_PROC_UUID_POLICY -DCONFIG_ECC_LOGGING -DCONFIG_COREDUMP -DCONFIG_VNGUARD -DCONFIG_PV_TICKET -DIOKITCPP -DIOKITSTATS -DIOTRACKING -DCONFIG_SLEEP -DCONFIG_MAX_THREADS="500" -DNO_KERNEL_HID -DLIBKERNCPP -DCONFIG_BLOCKS -DCONFIG_KEC_FIPS -DCONFIG_PERSONAS -DCONFIG_MACF -DCONFIG_MACF_SOCKET_SUBSET -DCONFIG_AUDIT -DCONFIG_ARCADE -DCONFIG_SETUID -DCONFIG_SECURE_BSD_ROOT -DCONFIG_KAS_INFO -DCONFIG_PROC_RESOURCE_LIMITS -DMACH_ASSERT -DCONFIG_ZLEAKS -DCONFIG_VOUCHER_DEPRECATED -DLOCK_STATS -DKPERF -DCONFIG_IOTRACE -DPGO -DDEVELOPMENT -DMACH_BSD -DIOKIT -DCONFIG_THREAD_MAX="2560" -DCONFIG_TASK_MAX="1024" -DCONFIG_ZONE_MAP_MIN="120586240" -DCONFIG_VC_PROGRESS_WHITE -DCONFIG_SCHED_TIMESHARE_CORE -DCONFIG_CLUTCH -DCONFIG_SCHED_AUTO_JOIN -DCONFIG_SCHED_SFI -DCONFIG_PROB_GZALLOC -DCONFIG_SCHED_DEFERRED_AST -DCONFIG_PREADOPT_TG -DMACH_KDP -DCONFIG_SERIAL_KDP -DCONFIG_KDP_INTERACTIVE_DEBUGGING -DCONFIG_KDP_COREDUMP_ENCRYPTION -DCONFIG_TASKWATCH -DCONFIG_USER_NOTIFICATION -DCONFIG_XNUPOST -DPROC_REF_DEBUG -DCONFIG_ATM -DCONFIG_COALITIONS -DCONFIG_SYSDIAGNOSE -DCONFIG_CSR -DCONFIG_CSR_FROM_DT -DSERIAL_CONSOLE -DVIDEO_CONSOLE -DCONFIG_REQUIRES_U32_MUNGING -DCONFIG_MACH_BRIDGE_RECV_TIME -DCONFIG_QUIESCE_COUNTER -DCONFIG_ARM_PFZ -DCONFIG_DARKBOOT -DCONFIG_SERVICE_PORT_INFO -DCONFIG_DELAY_IDLE_SLEEP -DCONFIG_PROC_UDATA_STORAGE -DSCHED_HYGIENE_DEBUG -DCONFIG_DEBUG_SYSCALL_REJECTION -DCONFIG_EXT_PANICLOG -DCONFIG_TASK_SUSPEND_STATS -DCONFIG_BTI_TELEMETRY -DALTERNATE_DEBUGGER -DCONFIG_MACH_APPROXIMATE_TIME -DCONFIG_KERNEL_INTEGRITY -DCONFIG_MACF_LAZY_VNODE_LABELS -DCONFIG_HYPERVISOR_PUBLIC -DCONFIG_RESLIDE_SHARED_CACHE
OSFMK_MACHINE=arm64
#
# Mach Operating System
# Copyright (c) 1986 Carnegie-Mellon University
# All rights reserved.  The CMU software License Agreement specifies
# the terms and conditions for use and redistribution.
#

export MakeInc_cmd=${SRCROOT}/makedefs/MakeInc.cmd
export MakeInc_def=${SRCROOT}/makedefs/MakeInc.def
export MakeInc_rule=${SRCROOT}/makedefs/MakeInc.rule
export MakeInc_dir=${SRCROOT}/makedefs/MakeInc.dir

include $(MakeInc_cmd)
include $(MakeInc_def)

#
# CFLAGS
#
CFLAGS+= -include meta_features.h -DPEXPERT_KERNEL_PRIVATE
SFLAGS+= -include meta_features.h

#
# Directories for mig generated files
#
COMP_SUBDIRS =

#
#  Make sure we don't remove this by accident if interrupted at the wrong
#  time.
#
.PRECIOUS: Makefile

#
#  Theses macros are filled in by the config program depending on the
#  current configuration.  The MACHDEP macro is replaced by the
#  contents of the machine dependent makefile template and the others
#  are replaced by the corresponding symbol definitions for the
#  configuration.
#

OBJS=device_tree.o bootargs.o pe_gen.o kcformat.o pe_bootargs.o \
	pe_consistent_debug.o pe_fiq.o pe_identify_machine.o pe_init.o \
	pe_kprintf.o pe_serial.o hwtrace.o 

LIBOBJS=

CFILES=\
	$(SOURCE_DIR)/pexpert/gen/device_tree.c \
	$(SOURCE_DIR)/pexpert/gen/bootargs.c \
	$(SOURCE_DIR)/pexpert/gen/pe_gen.c \
	$(SOURCE_DIR)/pexpert/gen/kcformat.c \
	$(SOURCE_DIR)/pexpert/arm/pe_bootargs.c \
	$(SOURCE_DIR)/pexpert/arm/pe_consistent_debug.c \
	$(SOURCE_DIR)/pexpert/arm/pe_fiq.c \
	$(SOURCE_DIR)/pexpert/arm/pe_identify_machine.c \
	$(SOURCE_DIR)/pexpert/arm/pe_init.c \
	$(SOURCE_DIR)/pexpert/arm/pe_kprintf.c \
	$(SOURCE_DIR)/pexpert/arm/pe_serial.c \
	$(SOURCE_DIR)/pexpert/arm/hwtrace/hwtrace.c 
COBJS=device_tree.o bootargs.o pe_gen.o kcformat.o pe_bootargs.o \
	pe_consistent_debug.o pe_fiq.o pe_identify_machine.o pe_init.o \
	pe_kprintf.o pe_serial.o hwtrace.o 

CXXFILES=
CXXOBJS=

SFILES=
SOBJS=

######################################################################
#BEGIN  Machine dependent Makefile fragment for arm64
######################################################################

######################################################################
#END    Machine dependent Makefile fragment for arm64
######################################################################

#
# Diagnostic opt-outs.  We need to make this list empty.
#
# DO NOT ADD MORE HERE.
#
# -Wno-cast-align
pe_identify_machine.o_CWARNFLAGS_ADD += -Wno-cast-align
# -Wno-implicit-int-conversion
pe_serial.o_CWARNFLAGS_ADD += -Wno-implicit-int-conversion
# -Wno-shorten-64-to-32
pe_identify_machine.o_CWARNFLAGS_ADD += -Wno-shorten-64-to-32
pe_init.o_CWARNFLAGS_ADD += -Wno-shorten-64-to-32
# -Wno-sign-conversion
bootargs.o_CWARNFLAGS_ADD += -Wno-sign-conversion
device_tree.o_CWARNFLAGS_ADD += -Wno-sign-conversion
pe_identify_machine.o_CWARNFLAGS_ADD += -Wno-sign-conversion
pe_init.o_CWARNFLAGS_ADD += -Wno-sign-conversion
pe_serial.o_CWARNFLAGS_ADD += -Wno-sign-conversion

# Rebuild if per-file overrides change
${OBJS}: $(firstword $(MAKEFILE_LIST))

# Rebuild if global compile flags change
$(COBJS): .CFLAGS
.CFLAGS: ALWAYS
	$(_v)$(REPLACECONTENTS) $@ $(KCC) $(CFLAGS) $(INCFLAGS)
$(CXXOBJS): .CXXFLAGS
.CXXFLAGS: ALWAYS
	$(_v)$(REPLACECONTENTS) $@ $(KC++) $(CXXFLAGS) $(INCFLAGS)
$(SOBJS): .SFLAGS
.SFLAGS: ALWAYS
	$(_v)$(REPLACECONTENTS) $@ $(S_KCC) $(SFLAGS) $(INCFLAGS)

$(COMPONENT).filelist: $(OBJS)
	@$(LOG_LDFILELIST) "$(COMPONENT)"
	$(_v)for obj in ${OBJS}; do	\
		 $(ECHO) $(TARGET)/$(CURRENT_KERNEL_CONFIG)/$${obj}; \
	done > $(COMPONENT).filelist

$(COMPONENT).libfilelist: $(LIBOBJS)
	@$(LOG_LDFILELIST) "lib$(COMPONENT)"
	$(_v)for obj in ${LIBOBJS}; do	\
		 $(ECHO) $(TARGET)/$(CURRENT_KERNEL_CONFIG)/$${obj}; \
	done > $(COMPONENT).libfilelist

ifeq ($(RC_ProjectName),xnu_libraries)
do_all: $(COMPONENT).libfilelist
else
do_all: $(COMPONENT).filelist
endif

do_build_all:: do_all

-include device_tree.d
device_tree.o: $(SOURCE_DIR)/pexpert/gen/device_tree.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/gen/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/gen/${C_RULE_4B})
-include bootargs.d
bootargs.o: $(SOURCE_DIR)/pexpert/gen/bootargs.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/gen/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/gen/${C_RULE_4B})
-include pe_gen.d
pe_gen.o: $(SOURCE_DIR)/pexpert/gen/pe_gen.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/gen/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/gen/${C_RULE_4B})
-include kcformat.d
kcformat.o: $(SOURCE_DIR)/pexpert/gen/kcformat.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/gen/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/gen/${C_RULE_4B})
-include pe_bootargs.d
pe_bootargs.o: $(SOURCE_DIR)/pexpert/arm/pe_bootargs.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include pe_consistent_debug.d
pe_consistent_debug.o: $(SOURCE_DIR)/pexpert/arm/pe_consistent_debug.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include pe_fiq.d
pe_fiq.o: $(SOURCE_DIR)/pexpert/arm/pe_fiq.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include pe_identify_machine.d
pe_identify_machine.o: $(SOURCE_DIR)/pexpert/arm/pe_identify_machine.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include pe_init.d
pe_init.o: $(SOURCE_DIR)/pexpert/arm/pe_init.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include pe_kprintf.d
pe_kprintf.o: $(SOURCE_DIR)/pexpert/arm/pe_kprintf.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include pe_serial.d
pe_serial.o: $(SOURCE_DIR)/pexpert/arm/pe_serial.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/${C_RULE_4B})
-include hwtrace.d
hwtrace.o: $(SOURCE_DIR)/pexpert/arm/hwtrace/hwtrace.c
	${C_RULE_0}
	${C_RULE_1A} $(SOURCE_DIR)/pexpert/arm/hwtrace/${C_RULE_1B}
	${C_RULE_2}
	${C_RULE_3}
	$(if ${C_RULE_4A},${C_RULE_4A}$(SOURCE_DIR)/pexpert/arm/hwtrace/${C_RULE_4B})

include $(MakeInc_rule)
include $(MakeInc_dir)
